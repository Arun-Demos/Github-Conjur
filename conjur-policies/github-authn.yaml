- !policy
  id: github
  body:
    - !webservice

    # Config vars (set values after loading)
    - !variable jwks-uri
    - !variable token-app-property
    - !variable identity-path
    - !variable issuer
    - !variable enforced-claims

    # Workloads allowed to authenticate
    - !group apps
    - !permit
      role: !group apps
      privileges: [ read, authenticate ]
      resource: !webservice

    # Status endpoint + operators for managing the authenticator and checking its status
    - !webservice
      id: status
    - !group operators
    - !permit
      role: !group operators
      privileges: [ read ]
      resource: !webservice status

    # Allow operators to read/update the authenticator webservice (optional but handy)
    - !permit
      role: !group operators
      privilege: [ read, update ]
      resource: !webservice
